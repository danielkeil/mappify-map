<!DOCTYPE html>
<html ng-app="exampleApp">
<head>
    <script src="http://maps.google.com/maps/api/js?v=3&sensor=false"></script>
    <script src="../bower_components/angular/angular.min.js"></script>
    <script src="../bower_components/leaflet/dist/leaflet.js"></script>
    <script src="../bower_components/bluebird/js/browser/bluebird.js"></script>
    <script src="../bower_components/lodash/dist/lodash.min.js"></script>
    <script src="../bower_components/leaflet-plugins/layer/tile/Google.js"></script>
    <script src="../bower_components/Leaflet.awesome-markers/dist/leaflet.awesome-markers.js"></script>

    <script src="../dist/mappify-map.js"></script>
    <link rel="stylesheet" href="../bower_components/normalize.css/normalize.css"/>

    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css"/>

    <link rel="stylesheet" href="./css/example.css"/>

    <link rel="stylesheet" href="../bower_components/leaflet/dist/leaflet.css"/>
    <link rel="stylesheet" href="../bower_components/Leaflet.awesome-markers/dist/leaflet.awesome-markers.css"/>
    <link rel="stylesheet" href="../bower_components/components-font-awesome/css/font-awesome.min.css"/>

    <script>
        var app = angular.module('exampleApp', ['mappify']);
        app.controller('ExampleController', ['$scope', '$q', '$http', function ($scope, $q, $http) {

            var URLS = {
                FETCH: './jsondata/polygon_germany.json'
            };

            function normalizeConcept(concept) {
                concept.markers = _.map(concept.markers, normalizeMarkers);

                return concept;
            }

            function normalizeMarkers(markers) {
                markers.polygon = _.map(markers.polygon, normalizePolygon);

                return markers;
            }

            function normalizePolygon(point) {
                return [point[1], point[0]];
            }

            $scope.datasource = {};
            $scope.datasource.fetchData = function () {
                return $http.get(URLS.FETCH).then(function (data) {
                    data = data.data;

                    data = _.map(data, normalizeConcept);

                    return data;
                });
            }

        }]);
    </script>
</head>
<body ng-controller="ExampleController">
<div class="container-fluid">
    <div class="row">
        <div class="col-md-12" style="min-height: 800px;">
            <h1>04 polygon example</h1>

            <div>
            </div>
            <div class="row">
                <div class="col-md-9" style="min-height: 800px;">
                    <mappify id="map" datasource="datasource" center="">
                        <mappify-search id="askjdklajd"></mappify-search>
                        <mappify-marker concept="conceptA" template-url="./template/example.tpl.html"></mappify-marker>
                    </mappify>
                </div>
                <div class="col-md-3" style="min-height: 800px;">
                </div>
            </div>
        </div>

</body>
</html>